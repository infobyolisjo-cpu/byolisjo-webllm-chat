<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>ByOlisJo Chat</title>
  <style>
  body{
  margin:0;
  font-family: Arial, sans-serif;
  background:#f5f2ee;
  color:#2b2b2b;
}

  .container{
    max-width:520px;
    margin:0 auto;
    padding:28px 16px 60px;
  }

  .toplink{
    display:inline-block;
    background:#000;
    color:#fff;
    padding:10px 16px;
    text-decoration:none;
    font-weight:600;
    border-radius:10px;
    margin-bottom:16px;
  }

  h1{
    margin:10px 0 18px;
    font-size:22px;
  }

  .chat{
  border:1px solid #e2ddd6;
  border-radius:16px;
  padding:16px;
  background:#ffffff;
}

  .chat h3{
    margin:0 0 14px 0;
  }

  #chatBox{
  height:240px;
  overflow-y:auto;
  border:1px solid #e2ddd6;
  border-radius:12px;
  padding:12px;
  margin-bottom:18px;
  background:#faf9f7;
}

#chatBox p{
  line-height:1.6;
  margin:0 0 12px 0;
}
#chatBox p b{
  font-weight:600;
}

 #userInput{
  width: calc(100% - 110px);
  padding:12px;
  border-radius:12px;
  border:1px solid #e2ddd6;
  background:#ffffff;
  color:#2b2b2b;
  margin-right:12px;
  box-sizing:border-box;
}

  #userInput:focus{
  outline:none;
  border-color:#b8a07c;
}
   

.send{
  padding:10px 12px;
  border-radius:10px;
  border:none;
  background:#b8a07c;
  color:#ffffff;
  font-weight:700;
  cursor:pointer;
}

</style>
</head>
<body>
  <div class="container">
  <a class="toplink" href="https://byolisjo.com">ByOlisjo</a>

  <h1>üöÄ Bienvenido a ByOlisJo</h1>
  

  <!-- Caja del chat -->
  <div class="chat">
    <h3>üí¨ Chat ByOlisJo</h3>
    <div id="chatBox">
      <p><b>Bot:</b> ¬°Hola! Soy tu asistente. ¬øEn qu√© puedo ayudarte?</p>
    </div>
   <input id="userInput" type="text" placeholder="Escribe tu mensaje aqu√≠...">
<button class="send" onclick="sendMessage()">Enviar</button>
  </div>

  <!-- Script para manejar el chat -->
  <script>
    let history = [];

    async function sendMessage() {
      const input   = document.getElementById("userInput");
      const chatBox = document.getElementById("chatBox");
      const text    = input.value.trim();
      if (!text) return;

      // Mostrar tu mensaje
      chatBox.innerHTML += `<p><b>T√∫:</b> ${text}</p>`;
      input.value = "";

      // Indicador de "escribiendo..."
      const loaderId = "ldr-" + Date.now();
      chatBox.innerHTML += `<p id="${loaderId}"><b>Bot:</b> escribiendo‚Ä¶</p>`;
      chatBox.scrollTop = chatBox.scrollHeight;

      try {
        const r = await fetch("/api/chat", {
          method: "POST",
          headers: { "Content-Type": "application/json" },
          body: JSON.stringify({ message: text, history })
        });

        const data  = await r.json();
        const reply = data.reply || "No pude responder. Intenta de nuevo.";

        // Reemplaza el ‚Äúescribiendo...‚Äù por la respuesta real
        document.getElementById(loaderId).remove();
        chatBox.innerHTML += `<p><b>Bot:</b> ${reply}</p>`;
        chatBox.scrollTop = chatBox.scrollHeight;

        // Guardar contexto
        history.push({ role: "user", content: text });
        history.push({ role: "assistant", content: reply });

      } catch (e) {
        document.getElementById(loaderId).textContent = "‚ö†Ô∏è Error de conexi√≥n. Intenta otra vez.";
      }
    }
  </script>
    </div>
</body>
</html>







